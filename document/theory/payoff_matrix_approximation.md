# 利得行列近似（構造を変えにくい近似）の理論メモ

## 目的
対称ゲームの利得行列 \(A\) に対して、ゲーム理論的な構造（特に均衡周辺の性質）をできるだけ壊さない近似を考える。

本メモでは、\(A\) を

\[
A = J + R
\]

と分解し、

- \(J\)：最大固有値に対応する主要な Rank 2 成分
- \(R\)：残差成分

として扱う。

ここで \(A\) は交代行列（反対称行列）を想定するため、固有値は純虚数の共役ペアで現れる。  
「最大固有値」とは、この純虚数ペアの絶対値が最も大きいものを指す。

## 基本方針
\(R\) が小さい状況では、\(R\) の形をある程度変更してもゲーム全体への影響は小さいと期待できる。  
そこで、均衡解 \(u\) まわりの性質を維持しつつ、\(R\) をより扱いやすい形に近似する。

変更後の近似行列を \(B\) とし、成分ごとに

\[
B_{ij} = J_{ij} + p_i - p_j
\]

の形を採用する。  
これは、\(A=J+R\) の残差部分に対して

\[
R_{ij} \approx p_i - p_j
\]

となるように近似することに相当する。

## 保ちたい条件
元の均衡解 \(u\) に対して

\[
Au = Bu
\]

を保つことを目標にする。  
上の \(B\) の定義を使うと、これは残差部分について

\[
\sum_j R_{ij}u_j = \sum_j (p_i - p_j)u_j
\]

を満たすことに対応する。

## 導出
右辺を整理すると

\[
\sum_j (p_i - p_j)u_j
= p_i\sum_j u_j - \sum_j p_j u_j
= p_i - \sum_j p_j u_j
\]

（\(u\) は確率ベクトルなので \(\sum_j u_j=1\)）。

これを行列形式で書くために

\[
U_{ij} = \delta_{ij} - u_j
\]

を定義すると、

\[
(U p)_i = p_i - \sum_j u_j p_j
\]

となるため、条件は

\[
U p = R u
\]

と書ける。

したがって、\(U\) が可逆であれば

\[
p = U^{-1}Ru
\]

で \(p\) を求められる。

## まとめ
- \(A\) を主要成分 \(J\) と残差 \(R\) に分解する。  
- 残差を \(p_i-p_j\) 形で近似し、\(B_{ij}=J_{ij}+p_i-p_j\) で \(B\) を構成する。  
- 均衡解 \(u\) に対して \(Au=Bu\) を保つため、\(p\) は \(Up=Ru\) を満たすように選ぶ。  
- 可逆性が成立する範囲では、\(p=U^{-1}Ru\) により計算できる。

以上が、ゲーム構造を大きく変えにくい \(A\to B\) 近似の理論的な出発点である。
